rules:
  - id: dangerous-system-functions
    message: "Potential security risk: Dangerous system function detected."
    severity: ERROR
    languages:
      - javascript
    pattern-either:
      - pattern: "require('child_process').exec($ARG, ...)"
      - pattern: "require('child_process').execSync($ARG, ...)"
      - pattern: "require('child_process').spawn($ARG, ...)"
      - pattern: "require('child_process').spawnSync($ARG, ...)"
      - pattern: "require('fs').writeFileSync($ARG, ...)"
      - pattern: "require('fs').writeFile($ARG, ...)"
      - pattern: "require('fs').readFileSync($ARG, ...)"
      - pattern: "require('fs').unlinkSync($ARG, ...)"
      - pattern: "require('fs').rmSync($ARG, ...)"
      - pattern: "eval($ARG)"
      - pattern: "new Function($ARG)"
      - pattern: "setTimeout($ARG, ...)"
      - pattern: "setInterval($ARG, ...)"
      - pattern: "process.env[$VAR]"
      - pattern: "require('net').createServer(...)"
      - pattern: "require('net').Socket(...)"
      - pattern: "require('http').createServer(...)"
      - pattern: "require('https').createServer(...)"
      - pattern: "require('dgram').createSocket(...)"
      - pattern: "require('net').connect(...)"
      - pattern: "require('dgram').bind(...)"
      - pattern: "require('net').Server(...)"
      - pattern: "exec(...)"
      - pattern: "spawn(...)"
      - pattern: "require('fs')"
      - pattern: "fs.$FUNC(...)"
      - pattern: "fs.writeFileSync($ARG, ...)"
      - pattern: "fs.writeFile($ARG, ...)"
      - pattern: "fs.readFileSync($ARG, ...)"
      - pattern: "fs.unlinkSync($ARG, ...)"
      - pattern: "fs.rmSync($ARG, ...)"
      - pattern: "require('net')"
      - pattern: "require('http')"
      - pattern: "require('https')"
      - pattern: "require('dgram')"
      - pattern: "require('net').createServer(...)"
      - pattern: "require('net').Socket(...)"
      - pattern: "require('http').createServer(...)"
      - pattern: "require('https').createServer(...)"
      - pattern: "require('dgram').createSocket(...)"
      - pattern: "require('net').connect(...)"
      - pattern: "require('dgram').bind(...)"
      - pattern: "require('net').Server(...)"
      - pattern: "net.createServer(...)"
      - pattern: "net.Server(...)"
      - pattern: "net.connect(...)"
      - pattern: "net.createServer((socket) => { $FUNC })"
      - pattern: "socket.write(...)"
      - pattern: "socket.send(...)"
